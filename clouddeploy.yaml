apiVersion: deploy.cloud.google.com/v1alpha1
kind: Pipeline
metadata:
  name: my-python-app-pipeline
spec:
  stages:
    - name: "deploy"
      targets:
        - name: "my-cloud-run-target"  # Cloud Run target environment
      release:
        name: "my-python-app-release"  # Release name for the rollout
        description: "My Python app release rollout"
        resources:
          - name: "my-python-app-service"  # Cloud Run service to be deployed
            type: "cloudrun"  # Cloud Run service type

  rollout:
    rolloutStrategy: "STANDARD"  # Rollout strategy: "STANDARD" or "CANARY"
    rolloutStart:
      releaseName: "my-python-app-release"
      deployTo:
        environments:
          - "prod"  # Target environment, like "prod" or others
      rolloutPolicy:
        maxConcurrent: 1   # Maximum number of concurrent deployments
        maxFailed: 1       # Maximum number of failed rollouts
        successThreshold: 1  # Minimum number of successful rollouts

# Additional configuration options for deployment, if needed:
# - Can add more stages or targets for different environments (staging, dev, etc.)
# - Modify rollout strategy as per the requirement for advanced rollouts
